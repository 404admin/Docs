@page
@model IndexModel
@using Microsoft.Extensions.Configuration
@inject IConfiguration Configuration
@{
    ViewData["Title"] = "Configuration Sample";
}

<h1>@ViewData["Title"]</h1>

<div class="row">
    <div class="col-md-8">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title">Configuration key-value pairs</h2>
            </div>
            <div class="panel-body">
                <p>The app's configuration contains the following key-value pairs. Because the Environment Variable Configuration Provider (<code>AddEnvironmentVariables</code>) is used without a prefix filter, all of the system's environment variables are included in the app's configuration. Therefore, this Index page filters the configuration values before displaying them here.</p>
                <ul>
                    @foreach(var kvp in Model.FilteredConfiguration)
                    {
                        <li>@kvp.Key : @kvp.Value</li>
                    }
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title">Bind to a POCO class</h2>
            </div>
            <div class="panel-body">
                <p>Configuration is provided to the app from the <em>starship.json</em> file using a File Configuration Provider (<code>AddJsonFile</code>):</p>
                <pre><code>{
  "starship": {
    "name": "USS Enterprise",
    "registry": "NCC-1701",
    "class": "Constitution",
    "length": 304.8,
    "commissioned": false
  },
  "trademark": "USS Enterprise® Paramount Pictures Corp. http://www.paramount.com"
}</code></pre>
                <p>The app has a <code>Starship</code> model POCO class:</p>
                <pre><code>public class Starship
{
    public string Name { get; set; }
    public string Registry { get; set; }
    public string Class { get; set; }
    public int Length { get; set; }
    public bool Commissioned { get; set; }
}</code></pre>
                <p>Using the <code>GetSection</code> and <code>Bind</code> methods, the configuration is bound to the POCO class:</p>
                <pre><code>public Starship Starship { get; private set; }
...
var starship = new Starship();
_config.GetSection("starship").Bind(starship);
Starship = starship;</code></pre>
                <p>The page model's <code>Starship</code> property displays the bound data using <code>@Model.Starship.&lt;Property&gt;</code> Razor syntax:</p>
                <ul>
                    <li>Name: @Model.Starship.Name</li>
                    <li>Registry: @Model.Starship.Registry</li>
                    <li>Class: @Model.Starship.Class</li>
                    <li>Length: @Model.Starship.Length</li>
                    <li>Commissioned: @Model.Starship.Commissioned</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title">Bind to a POCO class object graph</h2>
            </div>
            <div class="panel-body">
                <p>Configuration is provided to the app from the <em>tvshow.xml</em> file using a File Configuration Provider (<code>AddXmlFile</code>):</p>
                <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
  &lt;tvshow&gt;
    &lt;metadata&gt;
      &lt;series&gt;Dr. Who&lt;/series&gt;
      &lt;title&gt;The Sun Makers&lt;/title&gt;
      &lt;airdate&gt;11/26/1977&lt;/airdate&gt;
      &lt;episodes&gt;4&lt;/episodes&gt;
    &lt;/metadata&gt;
    &lt;actors&gt;
        &lt;names&gt;Tom Baker, Louise Jameson, John Leeson&lt;/name&gt;
    &lt;/actors&gt;
    &lt;legal&gt;©1977 BBC http://www.bbc.co.uk/doctorwho/classic/episodeguide/sunmakers/detail.shtml&lt;/legal&gt;
  &lt;/tvshow&gt;
&lt;/configuration&gt;</code></pre>
                <p>The app has a <code>TVShow</code> model POCO class object graph:</p>
                <pre><code>public class TvShow
{
    public Metadata Metadata { get; set; }
    public Actors Actors { get; set; }
    public string Legal { get; set; }
}

public class Metadata
{
    public string Series { get; set; }
    public string Title { get; set; }
    public DateTime Airdate { get; set; }
    public int Episodes { get; set; }
}

public class Actors
{
    public string Names { get; set; }
}</code></pre>
                <p>Using the <code>GetSection</code> and <code>Bind</code> methods, the configuration is bound to the POCO class object model:</p>
                <pre><code>public TvShow TvShow { get; private set; }
...
var tvShow = new TvShow();
_config.GetSection("tvshow").Bind(tvShow);
TvShow = tvShow;</code></pre>
                <p>The page model's <code>TvShow</code> property displays the bound data:</p>
                <ul>
                    <li>Series: @Model.TvShow.Metadata.Series</li>
                    <li>Title: @Model.TvShow.Metadata.Title</li>
                    <li>Airdate: @Model.TvShow.Metadata.Airdate</li>
                    <li>Episodes: @Model.TvShow.Metadata.Episodes</li>
                    <li>Actors:  @Model.TvShow.Actors.Names</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h2 class="panel-title">Custom Entity Framework Configuration Provider</h2>
            </div>
            <div class="panel-body">
                <p></p>
                <ul>
                    <li>Quote1: @Configuration["quote1"]</li>
                    <li>Quote2: @Configuration["quote2"]</li>
                    <li>Quote3: @Configuration["quote3"]</li>
                </ul>
            </div>
        </div>
    </div>
</div>
